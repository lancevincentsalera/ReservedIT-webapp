@using System.Security.Claims;

@{
    var claimsIdentity = User.Identity as ClaimsIdentity;
    var role = "";
    if (claimsIdentity != null)
    {
        role = claimsIdentity.FindFirst(ClaimTypes.Role).Value;
    }
}
<div class="sidebar">
    <div class="logo-container">
        <img src="~/img/reservedit-logo.png" />
    </div>
    <ul>
        @if (role == "ROLE_ADMIN")
        {
            <li>
                <a asp-action="Index" asp-controller="Room">
                    <img src="~/img/user-sidebar-logo.png" />
                    Rooms
                </a>

            </li>
            <li>
                <a asp-action="Index" asp-controller="AAUser">
                    <img src="~/img/room-sidebar-logo.png" />
                    Users
                </a>
            </li>
        }
        else if (role == "ROLE_MANAGER")
        {
            <li>
                <a asp-action="Index" asp-controller="MMDashboard">
                    <img src="~/img/dashboard-logo.png" />
                    Dashboard
                </a>

            </li>
            <li>
                <a asp-action="RoomView" asp-controller="Room">
                    <img src="~/img/user-sidebar-logo.png" />
                    Rooms
                </a>

            </li>
            <li>
                <a>
                    <img src="~/img/bookings-logo.png" />
                    Bookings
                </a>
            </li>
            <li>
                <a>
                    <img src="~/img/calendar-logo.png" />
                    Calendar
                </a>
            </li>
            <li>
                <a>
                    <img src="~/img/reports-logo.png" />
                    Reports
                </a>
            </li>
        }
        else
        {
            <li>
                <a>
                    <img src="~/img/dashboard-logo.png" />
                    Dashboard
                </a>

            </li>
            <li>
                <a asp-action="RoomView" asp-controller="Room">
                    <img src="~/img/user-sidebar-logo.png" />
                    Rooms
                </a>

            </li>
            <li>
                <a>
                    <img src="~/img/calendar-logo.png" />
                    Calendar
                </a>
            </li>
        }
    </ul>
    <div class="list-2">
        <ul >
            <li>
                <a asp-action="Index" asp-controller="Setting">
                    <img src="~/img/settings-logo.png" />
                    Settings
                </a>
                
            </li>
            <li>
                <a asp-action="SignOutUser" asp-controller="Account"> <img src="~/img/logout-sidebar-logo.png" />Logout</a>
            </li>
        <ul>
    </div>
    
</div>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const sidebarItems = document.querySelectorAll('a');

        const setActiveClass = () => {
            const currPath = window.location.pathname;

            sidebarItems.forEach(item => {
                if (item.getAttribute('href') === currPath) {
                    item.parentElement.classList.add('active');
                } else {
                    item.parentElement.classList.remove('active');
                }
            });
        };

        setActiveClass();

        sidebarItems.forEach(item => {
            item.addEventListener('click', function (e) {
                sidebarItems.forEach(item => {
                    item.parentElement.classList.remove('active');
                });

                this.parentElement.classList.add('active');
            });
        });
    });

</script>
